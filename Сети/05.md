# 5. Формат IP-адреса: использование масок. Виды представления масок. Разбиение и объединение сетей

Масленников: 5

## Формат IP-адреса

==В заголовке IP-пакета предусмотрены поля для хранения _IP-адреса отправителя_ и _IP-адреса получателя_. Каждое из этих полей имеет фиксированную длину 4 байта (32 бита). Как уже было сказано, IP-адрес состоит из двух логических частей — номера сети и номера узла в сети.==(стр.405) Наиболее распространенная форма представления IP-адреса — запись в виде четырех чисел, представляющих значения каждого байта в десятичной форме и разделенных точками, например:

128.10.2.30

Этот же адрес может быть представлен в двоичном формате:

10000000 00001010 00000010 00011110

В шестнадцатеричном формате тот же адрес имеет следующий вид:

80.0А.02.1D

==Запись адреса не предусматривает _специального разграничительного знака_ между номером сети и номером узла.== Вместе с тем при передаче пакета по сети часто возникает необходимость разделить адрес на эти две части. Например, маршрутизация, как правило, осуществляется на основании номера сети, поэтому каждый маршрутизатор, получая пакет, должен прочитать из соответствующего поля заголовка адрес назначения и выделить из него номер сети. ==Каким образом маршрутизаторы определяют, какая часть из 32 бит, отведенных под IP-адрес, относится к номеру сети, а какая — к номеру узла?==

Можно предложить несколько вариантов решения этой проблемы.

==Простейший из них состоит в использовании фиксированной границы. При этом все 32-битное поле адреса заранее делится на две части не обязательно равной, но фиксированной длины, в одной из которых всегда будет размещаться номер сети, в другой — номер узла.== Решение очень простое, но хорошее ли? Поскольку поле, которое отводится для хранения номера узла, имеет фиксированную длину, все сети будут иметь одинаковое максимальное число узлов. Если, например, под номер сети отвести один первый байт, то все адресное пространство распадется на сравнительно небольшое (28) число сетей огромного размера (224 узлов). Если границу передвинуть дальше вправо, то сетей станет больше, но все равно все они будут одинакового размера. Очевидно, что такой жесткий подход не позволяет дифференцированно удовлетворять потребности отдельных предприятий и организаций. Именно поэтому он не нашел применения, хотя и использовался на начальном этапе существования технологии TCP/IP.

==Второй подход (RFC 950, RFC 1518) основан на применении маски, которая позволяет максимально гибко устанавливать границу между номером сети и номером узла.== При таком подходе адресное пространство можно использовать для создания множества сетей разного размера.

> Маска — это число, применяемое в паре с IP-адресом, причем двоичная запись маски содержит непрерывную последовательность единиц в тех разрядах, которые должны в IP-адресе интерпретироваться как номер сети. Граница между последовательностями единиц и нулей в маске соответствует границе между номером сети и номером узла в IP-адресе.

Например, если маска, связываемая с некоторым IP-адресом, имеет вид 1111111111110 0000000000000000000, то номеру сети соответствуют 10 старших разрядов в двоичном
представлении данного IP-адреса. И наконец, способ (RFC 791), основанный на классах адресов, представляет собой компромисс по отношению к двум предыдущим: размеры
сетей хотя и не могут быть произвольными, как при использовании масок, но и не должны быть одинаковыми, как при установлении фиксированных границ. Вводится пять классов адресов: A, B, C, D, E. Три из них — A, B и C — предназначены для адресации сетей, а два — D и E — имеют специальное назначение. Для каждого класса сетевых адресов определено собственное положение границы между номером сети и номером узла.

## 2. Виды представления маски

Маски могут записываться в двух основных форматах:

В виде четырёх десятичных октетов (традиционный формат). Например: 255.255.255.0.

В нотации [CIDR](https://ru.wikipedia.org/wiki/%D0%91%D0%B5%D1%81%D0%BA%D0%BB%D0%B0%D1%81%D1%81%D0%BE%D0%B2%D0%B0%D1%8F_%D0%B0%D0%B4%D1%80%D0%B5%D1%81%D0%B0%D1%86%D0%B8%D1%8F) (Classless Inter-Domain Routing): В этом формате после IP-адреса через слэш указывается количество единиц в маске. Например, 192.168.1.0/24 эквивалентно маске 255.255.255.0 (24 старших бита — единицы).

## 3. Разбиение и объединение сетей

Разбиение на подсети ([Subnetting](https://learn.microsoft.com/ru-ru/troubleshoot/windows-client/networking/tcpip-addressing-and-subnetting#subnetting)): Это процесс разделения одной крупной сети (например, класса A, B или C) на несколько меньших подсетей. Для этого администратор «занимает» несколько битов из поля номера узла исходной сети, превращая их в поле номера подсети. Это увеличивает длину маски (например, с /24 до /26). Впервые стандартная процедура была описана в [RFC 950](https://datatracker.ietf.org/doc/html/rfc950).

Цель: эффективное использование адресного пространства, логическое разделение сетей для безопасности и управления трафиком.

Пример: Сеть 192.168.123.0/24 (маска 255.255.255.0) с помощью маски 255.255.255.192 (или /26) может быть разбита на 4 подсети: 192.168.123.0, .64, .128, .192. В каждой такой подсети будет доступно для узлов адресов.

Объединение сетей ([Supernetting](https://en.wikipedia.org/wiki/Supernetwork)): Это обратный процесс, при котором несколько смежных сетей с одной маской объединяются в одну суперсеть с более короткой маской.

Цель: уменьшение записей в таблицах маршрутизации для повышения эффективности работы интернета. Например, вместо того, чтобы объявлять отдельно сети 192.168.0.0/24, 192.168.1.0/24, 192.168.2.0/24 и 192.168.3.0/24, маршрутизатор может объявить одну агрегированную сеть 192.168.0.0/22.
