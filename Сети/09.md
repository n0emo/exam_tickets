# 9. Формат ARP-пакета. ARP-таблица: типы записей. О работе ARP в сетях без широковещания. Протокол Proxy-ARP. Пример работы Proxy-ARP.

## Формат ARP-пакета.

| Поле                                 | Размер     | Пример            |
| ------------------------------------ | ---------- | ----------------- |
| Тип сети                             | 16         | 1 (0x1)(Ethernet) |
| Тип протокола                        | 16         | 2048 (0x800)(IP)  |
| Длина локального адреса              | 8          | 6 (0x6)           |
| Длина сетевого адреса                | 8          | 4 (0x4)           |
| Операция                             | 16         | 1 (0x1) (Запрос)  |
| Локальный адрес отправителя          | Переменный | 008048EB7E60      |
| Сетевой адрес отправителя            | Переменный | 194.85.135.75     |
| Локальный (искомый) адрес получателя | Переменный | 000000000000      |
| Сетевой адрес получателя             | Переменный | 194.85.135.65     |

## ARP-таблица: типы записей.

ARP-таблица имеет вид:
| IP-адрес | MAC-адрес | Тип записи |
| -------- | --------- | ---------- |

В ARP-таблицах существуют два типа записей: динамические и статические. Статические
записи создаются вручную с помощью утилиты arp и не имеют срока устаревания, точнее,
они существуют до тех пор, пока компьютер или маршрутизатор остается включенным.
Динамические записи должны периодически обновляться. Если запись не обновлялась
в течение определенного времени (порядка нескольких минут), то она исключается из таблицы. Таким образом, в ARP-таблице содержатся записи не обо всех узлах сети, а только о тех, которые активно участвуют в сетевых операциях. Поскольку такой способ хранения информации называют кэшированием, ARP-таблицы иногда называют ARP-кэшем.

## О работе ARP в сетях без широковещания.

В сетях, где нет широковещания, обычный ARP работать не сможет, для этого существует специальная модификация InARP, где устройства сами отправляют сообщения со своим IP, чтобы построить таблицу соответствий IP-адресов и идентификаторов каналов (например, DLCI), а не ждут широковещательного запроса, позволяя устройствам узнавать друг друга в сетях, где рассылка всем недоступна. 

## Протокол Proxy-ARP. Пример работы Proxy-ARP.

Протокол Proxy-ARP — это разновидность протокола ARP, позволяющая отображать IP-адреса
на аппаратные адреса в сетях, поддерживающих широковещание, даже в тех случаях, когда искомый узел находится за пределами данного домена коллизий.

Пример работы:

При подключении к сети удаленного узла в таблицу ARP-маршрутизатора заносится запись

IP(удаленного узла) — MAC1 — int2

Эта запись означает, что:

- при поступлении ARP-запроса на маршрутизатор относительно адреса IP(удаленного узла) в ARP-ответ будет помещен аппаратный адрес MAC1, соответствующий аппаратному адресу интерфейса 1 маршрутизатора;
- узел, имеющий адрес IP(удаленного узла), подключен к интерфейсу 2 маршрутизатора.

**Источники**
- https://library.tsilikin.ru/%D0%A2%D0%B5%D1%85%D0%BD%D0%B8%D0%BA%D0%B0/%D0%98%D0%BD%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D1%8B%D0%B5%20%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D0%B8/Network/%D0%9E%D0%BB%D0%B8%D1%84%D0%B5%D1%80%20%D0%92.%20%D0%9A%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80%D0%BD%D1%8B%D0%B5%20%D1%81%D0%B5%D1%82%D0%B8.pdf
- https://ru.wikipedia.org/wiki/ARP
- https://www.atraining.ru/arp-inarp-rarp-proxy-gratuitous-dai-sticky-and-more/
