# 17. Схема IP-маршрутизации на примере сети.

Схема IP-маршрутизации показывает, как пакеты данных перемещаются между сетями с
помощью маршрутизаторов, которые используют **таблицы маршрутизации**,
содержащие записи о сетях, шлюзах и метриках для выбора оптимального пути.

**Таблица маршрутизации** - Основной инструмент принятия решений о передаче
*пакетов содержит:

1. **Адрес назначения** — сеть, куда направлен пакет
2. **Адрес следующего маршрутизатора** — куда отправить пакет для продолжения пути
3. **Адрес выходного порта** — через какой собственный интерфейс передать пакет
4. **Метрика расстояния** — стоимость/расстояние до сети назначения(в числе хопов по сети)
5. **Маршрут по умолчанию** — запись для всех не указанных явно сетей (сокращает размер таблицы)

![Сеть](sources/17.jpg)

Рассмотрим механизм IP-маршрутизации на примере составной сети, представленной
на рис. 16.2. В этой сети 20 маршрутизаторов (изображенных в виде
пронумерованных квадратных блоков) объединяют 18 сетей в общую сеть; N1, N2,...,
N18 — это номера сетей. На каждом маршрутизаторе и конечных узлах А и В
функционируют протоколы IP. К нескольким интерфейсам (портам) маршрутизаторов
присоединяются сети.

Каждый интерфейс маршрутизатора можно рассматривать как
отдельный узел сети: он имеет сетевой адрес и локальный адрес в той подсети,
которая к нему подключена. Например, маршрутизатор под номером 1 имеет три
интерфейса, к которым подключены сети N1, N2, N3. На рисунке сетевые адреса этих
портов обозначены IP11, IP12 и IP13. Интерфейс IP11 является узлом сети N1, и,
следовательно, в поле номера сети порта IP11 содержится номер N1. Аналогично
интерфейс IP21 — это узел в сети N2, а порт IP13 — узел в сети N3. 

Таким образом, маршрутизатор можно рассматривать как совокупность нескольких
узлов, каждый из которых входит в свою сеть. Как единое устройство маршрутизатор
не имеет выделенного адреса, ни сетевого, ни локального.

В сложных составных сетях почти всегда существуют несколько альтернативных
маршрутов для передачи пакетов между двумя конечными узлами. Так, пакет,
отправленный из узла А в узел В, может пройти через маршрутизаторы 17,12, 5,4 и
1 или маршрутизаторы 17, 13, 7, 6 и 3.

При наличии у маршрутизатора блока управления (например, по протоколу SNMP) этот
блок имеет собственные локальный и сетевой адреса, по которым к нему обращается
центральная станция управления. Эти адреса выбираются из того же пула, что и
адреса физических интерфейсов маршрутизатора. В технической документации такого
рода адреса называются адресами обратной петли или адресами виртуальных
интерфейсов (virtual interface address). Задачу выбора маршрута из нескольких
возможных решают маршрутизаторы, а также конечные узлы.

## Источники

- https://studfile.net/preview/10472665/page:33/
